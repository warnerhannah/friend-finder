<!DOCTYPE html>
<html>

<head>
    <title>FriendFinder | Survey</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
        crossorigin="anonymous">
</head>

<body class="container">
    <div class="card">
        <div class="card-body">
            <h2 class="card-title">Survey Questions:</h5>

                <form>
                    <h4>About You</h4>
                    <div class="form-group" style="width: 400px;">
                        <label for="nameinput">Name (Required)</label>
                        <input type="input" class="form-control" id="nameinput" placeholder="Enter Name">
                    </div>
                    <div class="form-group" style="width: 400px;">
                        <label for="pictureinput">Link to Photo Image (Required)</label>
                        <input type="input" class="form-control" id="pictureinput" placeholder="www.exampleimage.com">
                    </div>
                </form>


                <div id="q1" style="padding-bottom: 20px">
                    <h3>Question 1</h3>
                    <h4 class="card-text">You are a morning person.</h4>
                    <input type="radio" name="q1" value="1"> 1 (Strongly Disagree)<br>
                    <input type="radio" name="q1" value="2"> 2<br>
                    <input type="radio" name="q1" value="3"> 3<br>
                    <input type="radio" name="q1" value="4"> 4<br>
                    <input type="radio" name="q1" value="5"> 5 (Strongly Agree)<br>
                </div>

                <div id="q2" style="padding-bottom: 20px">
                    <h3>Question 2</h3>
                    <h4 class="card-text">You are late often.</h4>
                    <input type="radio" name="q2" value="1"> 1 (Strongly Disagree)<br>
                    <input type="radio" name="q2" value="2"> 2<br>
                    <input type="radio" name="q2" value="3"> 3<br>
                    <input type="radio" name="q2" value="4"> 4<br>
                    <input type="radio" name="q2" value="5"> 5 (Strongly Agree)<br>
                </div>

                <div id="q3" style="padding-bottom: 20px">
                    <h3>Question 3</h3>
                    <h4 class="card-text">You enjoy talking to other people.</h4>
                    <input type="radio" name="q3" value="1"> 1 (Strongly Disagree)<br>
                    <input type="radio" name="q3" value="2"> 2<br>
                    <input type="radio" name="q3" value="3"> 3<br>
                    <input type="radio" name="q3" value="4"> 4<br>
                    <input type="radio" name="q3" value="5"> 5 (Strongly Agree)<br>
                </div>

                <div id="q4" style="padding-bottom: 20px">
                    <h3>Question 4</h3>
                    <h4 class="card-text">You fall asleep quickly.</h4>
                    <input type="radio" name="q4" value="1"> 1 (Strongly Disagree)<br>
                    <input type="radio" name="q4" value="2"> 2<br>
                    <input type="radio" name="q4" value="3"> 3<br>
                    <input type="radio" name="q4" value="4"> 4<br>
                    <input type="radio" name="q4" value="5"> 5 (Strongly Agree)<br>
                </div>

                <div id="q5" style="padding-bottom: 20px">
                    <h3>Question 5</h3>
                    <h4 class="card-text">You are a creative person.</h4>
                    <input type="radio" name="q5" value="1"> 1 (Strongly Disagree)<br>
                    <input type="radio" name="q5" value="2"> 2<br>
                    <input type="radio" name="q5" value="3"> 3<br>
                    <input type="radio" name="q5" value="4"> 4<br>
                    <input type="radio" name="q5" value="5"> 5 (Strongly Agree)<br>
                </div>

                <div id="q6" style="padding-bottom: 20px">
                    <h3>Question 6</h3>
                    <h4 class="card-text">You enjoy playing or viewing sports.</h4>
                    <input type="radio" name="q6" value="1"> 1 (Strongly Disagree)<br>
                    <input type="radio" name="q6" value="2"> 2<br>
                    <input type="radio" name="q6" value="3"> 3<br>
                    <input type="radio" name="q6" value="4"> 4<br>
                    <input type="radio" name="q6" value="5"> 5 (Strongly Agree)<br>
                </div>

                <div id="q7" style="padding-bottom: 20px">
                    <h3>Question 7</h3>
                    <h4 class="card-text">You are spontaneous.</h4>
                    <input type="radio" name="q7" value="1"> 1 (Strongly Disagree)<br>
                    <input type="radio" name="q7" value="2"> 2<br>
                    <input type="radio" name="q7" value="3"> 3<br>
                    <input type="radio" name="q7" value="4"> 4<br>
                    <input type="radio" name="q7" value="5"> 5 (Strongly Agree)<br>
                </div>

                <div id="q8" style="padding-bottom: 20px">
                    <h3>Question 8</h3>
                    <h4 class="card-text">You enjoy the outdoors.</h4>
                    <input type="radio" name="q8" value="1"> 1 (Strongly Disagree)<br>
                    <input type="radio" name="q8" value="2"> 2<br>
                    <input type="radio" name="q8" value="3"> 3<br>
                    <input type="radio" name="q8" value="4"> 4<br>
                    <input type="radio" name="q8" value="5"> 5 (Strongly Agree)<br>
                </div>

                <div id="q9" style="padding-bottom: 20px">
                    <h3>Question 9</h3>
                    <h4 class="card-text">You prefer to have a thought out plan.</h4>
                    <input type="radio" name="q9" value="1"> 1 (Strongly Disagree)<br>
                    <input type="radio" name="q9" value="2"> 2<br>
                    <input type="radio" name="q9" value="3"> 3<br>
                    <input type="radio" name="q9" value="4"> 4<br>
                    <input type="radio" name="q9" value="5"> 5 (Strongly Agree)<br>
                </div>

                <div id="q10" style="padding-bottom: 20px">
                    <h3>Question 1</h3>
                    <h4 class="card-text">You like to code.</h4>
                    <input type="radio" name="q10" value="1"> 1 (Strongly Disagree)<br>
                    <input type="radio" name="q10" value="2"> 2<br>
                    <input type="radio" name="q10" value="3"> 3<br>
                    <input type="radio" name="q10" value="4"> 4<br>
                    <input type="radio" name="q10" value="5"> 5 (Strongly Agree)<br>
                </div>
                <button class="btn btn-primary" id="submitbutton" href="#" data-toggle="modal" data-target="#exampleModal">Find my Best Friend!</button>
        </div>
    </div>

    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <p>Your Best Friend is: <span id="bfName"></span></p>
              <img src="" alt="Best Friend Picture">
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>

    <a href="/api/friends">API Friends List |</a>
    <a href="https://github.com/warnerhannah/friend-finder">| GitHub Repository</a>


    <script type="text/javascript">
        let newFriend;
        let bestFriend = {
            totalDiff: 100,
            name: "",
            pictureURL: ""
        }

        let arrayLen = 0;

        $("button").click(function (e) {
            e.preventDefault();

            newFriend = {
                name: $("#nameinput").val(),
                pic: $("#pictureinput").val(),
                scores: [$("input[name=q1]:checked").val(), $("input[name=q2]:checked").val(), $("input[name=q3]:checked").val(), $("input[name=q4]:checked").val(), $("input[name=q5]:checked").val(), $("input[name=q6]:checked").val(), $("input[name=q7]:checked").val(), $("input[name=q8]:checked").val(), $("input[name=q9]:checked").val(), $("input[name=q10]:checked").val()]
            }

            console.log(newFriend)

            compareFriends(newFriend);

            $.post({ url: '/api/friends', contentType: 'application/json' }, JSON.stringify(newFriend));
        });

        function compareFriends(newFriend) {
            console.log("hit")
            $.get("/api/friends", friendsArr => {
                console.log("array:")
                console.log(friendsArr);
                arrayLen = friendsArr.length
                friendsArr.forEach((friend) => {
                    console.log(friend)
                    calculation(newFriend, friend);
                });
                $("#bfName").text(bestFriend.name);
                $("#bfpic").attr("src", bestFriend.pictureURL)
                $('#exampleModal').modal("toggle");
            });
        }

        function calculation(you, them) {
            let totalDiff = 0;
            yourScores = parseInt(you.scores[i]);
            theirScores = parseInt(them.scores[i]);

            for (var i = 0; i < arrayLen-1; i++) {
                totalDiff += Math.abs(yourScores - theirScores);
            }
            console.log(totalDiff)

                if (totalDiff < bestFriend.totalDiff) {
                    bestFriend.totalDiff = totalDiff;
                    bestFriend.name = them.name;
                    bestFriend.pictureURL = them.pic;
                };
            console.log(bestFriend)
        }
    </script>
</body>

</html>